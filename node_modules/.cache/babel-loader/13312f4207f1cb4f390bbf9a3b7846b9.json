{"ast":null,"code":"var _jsxFileName = \"/Users/vedadnya_98/Documents/GitHub/Xpense/firebase-auth/src/components/Profile.js\";\nimport React from 'react';\nimport firebase from \"firebase/app\";\nimport \"firebase/storage\";\nimport SignOutButton from './SignOut';\nimport '../App.css';\nimport ChangePassword from './ChangePassword';\nimport { AuthContext } from \"../firebase/Auth\";\nimport { useEffect, useContext, useState } from 'react';\nimport { getUser, updateProfilePic, updateAccountInfo } from '../firebase/FirestoreFunctions';\n\nconst defpic = require('../assets/default-avatar.png');\n\nfunction Profile() {\n  const {\n    currentUser\n  } = useContext(AuthContext);\n  const [user, setUser] = useState();\n  const [loading, setLoading] = useState(true);\n  const [change, setChange] = useState(false);\n  const [profPic, setProfPic] = useState();\n  const [profPicUrl, setProfPicUrl] = useState();\n  const [formSubmit, setFormSubmit] = useState(false);\n  useEffect(() => {\n    async function getData() {\n      try {\n        let u = await getUser(currentUser.uid);\n        setLoading(false);\n        setUser(u);\n        console.log(profPicUrl);\n        console.log(\"enter useeffect after getting user\");\n      } catch (e) {\n        console.log(e);\n      }\n    }\n\n    getData();\n  }, [currentUser, profPicUrl, formSubmit]); //onChange handler for input field of profile picture\n\n  const handleChange = async event => {\n    event.preventDefault();\n\n    if (event.target.files[0]) {\n      const profilePicture = event.target.files[0];\n      setProfPic(profilePicture);\n    }\n  }; //submit function for profile picture form\n\n\n  const handleUpload = async event => {\n    event.preventDefault();\n    var metadata = {\n      contentType: 'image/jpeg'\n    };\n    var storageRef = firebase.storage().ref();\n    const storage = firebase.storage(); //var profilePictureRef = storageRef.child(`images/${profPic.name}`).put(profPic, metadata);\n\n    const uploadTask = storage.ref(`/images/${profPic.name}`).put(profPic);\n    console.log('img uploaded'); // Listen for state changes, errors, and completion of the upload.\n\n    uploadTask.on('state_changed', snapShot => {\n      //takes a snap shot of the process as it is happening\n      console.log(snapShot);\n    }, err => {\n      //catches the errors\n      console.log(err);\n    }, () => {\n      // gets the functions from storage refences the image storage in firebase by the children\n      // gets the download url then sets the image from firebase as the value for the imgUrl key:\n      storage.ref('images').child(profPic.name).getDownloadURL().then(fireBaseUrl => {\n        //setProfPicUrl(prevObject => ({...prevObject, imgUrl: fireBaseUrl}))\n        setProfPicUrl(fireBaseUrl);\n\n        try {\n          updateProfilePic(currentUser.uid, fireBaseUrl);\n        } catch (error) {\n          alert(error);\n        }\n\n        console.log('firebase url i s' + fireBaseUrl);\n      });\n    });\n  }; //function to update account details of the user\n\n\n  const handleAccountUpdate = async event => {\n    event.preventDefault();\n    console.log('entering update acc func'); //await updateAccountInfo(currentUser.uid,firstName,lastName);\n\n    let {\n      firstName,\n      lastName\n    } = event.target.elements;\n    const first = firstName.value;\n    const last = lastName.value;\n    console.log(\"form data \" + first + \"  \" + last);\n\n    if (first && last) {\n      try {\n        await updateAccountInfo(currentUser.uid, first, last);\n        setFormSubmit(true);\n      } catch (error) {\n        alert(error);\n      }\n    } else alert('enter all info');\n  }; //component code\n\n\n  if (!loading) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 5\n      }\n    }, \"Profile Page\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"profile\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 5\n      }\n    }, user && user.photoURL ? /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 32\n      }\n    }, \"Profile Picture\", /*#__PURE__*/React.createElement(\"img\", {\n      src: user.photoURL,\n      alt: \"profilePic\",\n      height: \"100\",\n      width: \"100\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 50\n      }\n    })) : /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 128\n      }\n    }, \"Default Picture\", /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 146\n      }\n    }), /*#__PURE__*/React.createElement(\"img\", {\n      src: defpic,\n      alt: \"defaultpic\",\n      height: \"100\",\n      width: \"100\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 152\n      }\n    })), /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: handleUpload,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 6\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"file\",\n      onChange: handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 7\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      style: {\n        border: '3px solid black'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 7\n      }\n    }, \"Change profile picture\")), user ? /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 15\n      }\n    }, \"First Name: \", user.firstName, \"  \", /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 48\n      }\n    }), \"Last Name: \", user.lastName) : /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 89\n      }\n    }, \"NOT GETTING USER DATA\"), user && user.posts ? /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 29\n      }\n    }, \"MY POSTS: \", user.posts.map(item => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 8\n        }\n      }, \"Post Details: \", item.title, \" : \", item.value), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 8\n        }\n      }, \"Post Description: \", item.description));\n    })) : /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 20\n      }\n    }, \"NOT GETTING any posts\")), /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 5\n      }\n    }, \"Edit account info\"), /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: handleAccountUpdate,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      for: \"firstName\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 6\n      }\n    }, \"First Name:\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      id: \"firstName\",\n      name: \"firstName\",\n      placeholder: \"Enter your first name\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 6\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 6\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      for: \"lastName\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 6\n      }\n    }, \"Last Name:\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      id: \"lastName\",\n      name: \"lastName\",\n      placeholder: \"Enter your last name\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 6\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 6\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      type: \"submit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 6\n      }\n    }, \"Apply changes\")), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 5\n      }\n    }), change ? /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(ChangePassword, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 20\n      }\n    }), \" \", /*#__PURE__*/React.createElement(\"button\", {\n      onClick: () => setChange(!change),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 39\n      }\n    }, \"Hide\")) : /*#__PURE__*/React.createElement(\"button\", {\n      onClick: () => setChange(!change),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 104\n      }\n    }, \"Click to Change Password\"), \" \", /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 182\n      }\n    }), /*#__PURE__*/React.createElement(SignOutButton, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 5\n      }\n    }));\n  } else {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 5\n      }\n    }, \" Loading...\"));\n  }\n}\n\nexport default Profile;","map":{"version":3,"sources":["/Users/vedadnya_98/Documents/GitHub/Xpense/firebase-auth/src/components/Profile.js"],"names":["React","firebase","SignOutButton","ChangePassword","AuthContext","useEffect","useContext","useState","getUser","updateProfilePic","updateAccountInfo","defpic","require","Profile","currentUser","user","setUser","loading","setLoading","change","setChange","profPic","setProfPic","profPicUrl","setProfPicUrl","formSubmit","setFormSubmit","getData","u","uid","console","log","e","handleChange","event","preventDefault","target","files","profilePicture","handleUpload","metadata","contentType","storageRef","storage","ref","uploadTask","name","put","on","snapShot","err","child","getDownloadURL","then","fireBaseUrl","error","alert","handleAccountUpdate","firstName","lastName","elements","first","value","last","photoURL","border","posts","map","item","title","description"],"mappings":"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","sourcesContent":["import React from 'react';\nimport firebase from \"firebase/app\";\nimport \"firebase/storage\";\nimport SignOutButton from './SignOut';\nimport '../App.css';\nimport ChangePassword from './ChangePassword';\nimport { AuthContext } from \"../firebase/Auth\";\nimport { useEffect, useContext, useState } from 'react';\nimport { getUser, updateProfilePic, updateAccountInfo } from '../firebase/FirestoreFunctions';\n\nconst defpic = require('../assets/default-avatar.png')\n\nfunction Profile() {\n\tconst { currentUser } = useContext(AuthContext);\n\tconst [user, setUser] = useState();\n\tconst [loading, setLoading] = useState(true);\n\tconst [change, setChange] = useState(false);\n\tconst [profPic, setProfPic] = useState();\n\tconst [profPicUrl, setProfPicUrl] = useState();\n\tconst [formSubmit, setFormSubmit] = useState(false);\n\n\tuseEffect(() => {\n\n\t\tasync function getData() {\n\t\t\ttry {\n\t\t\t\tlet u = await getUser(currentUser.uid);\n\n\t\t\t\tsetLoading(false)\n\n\t\t\t\tsetUser(u);\n\n\n\t\t\t\tconsole.log(profPicUrl);\n\n\t\t\t\tconsole.log(\"enter useeffect after getting user\")\n\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log(e)\n\t\t\t}\n\t\t}\n\t\tgetData();\n\t}, [currentUser, profPicUrl, formSubmit]);\n\n\n\n\t//onChange handler for input field of profile picture\n\tconst handleChange = async (event) => {\n\t\tevent.preventDefault();\n\t\tif (event.target.files[0]) {\n\t\t\tconst profilePicture = event.target.files[0];\n\t\t\tsetProfPic(profilePicture);\n\t\t}\n\t}\n\n\t//submit function for profile picture form\n\tconst handleUpload = async (event) => {\n\t\tevent.preventDefault();\n\t\tvar metadata = {\n\t\t\tcontentType: 'image/jpeg'\n\t\t};\n\t\tvar storageRef = firebase.storage().ref();\n\t\tconst storage = firebase.storage();\n\t\t//var profilePictureRef = storageRef.child(`images/${profPic.name}`).put(profPic, metadata);\n\t\tconst uploadTask = storage.ref(`/images/${profPic.name}`).put(profPic);\n\t\tconsole.log('img uploaded');\n\n\t\t// Listen for state changes, errors, and completion of the upload.\n\t\tuploadTask.on('state_changed',\n\t\t\t(snapShot) => {\n\t\t\t\t//takes a snap shot of the process as it is happening\n\t\t\t\tconsole.log(snapShot)\n\t\t\t}, (err) => {\n\t\t\t\t//catches the errors\n\t\t\t\tconsole.log(err)\n\t\t\t}, () => {\n\t\t\t\t// gets the functions from storage refences the image storage in firebase by the children\n\t\t\t\t// gets the download url then sets the image from firebase as the value for the imgUrl key:\n\t\t\t\tstorage.ref('images').child(profPic.name).getDownloadURL()\n\t\t\t\t\t.then(fireBaseUrl => {\n\t\t\t\t\t\t//setProfPicUrl(prevObject => ({...prevObject, imgUrl: fireBaseUrl}))\n\t\t\t\t\t\tsetProfPicUrl(fireBaseUrl);\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tupdateProfilePic(currentUser.uid, fireBaseUrl);\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\talert(error);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconsole.log('firebase url i s' + fireBaseUrl);\n\t\t\t\t\t})\n\n\t\t\t})\n\n\t}\n\n\t//function to update account details of the user\n\tconst handleAccountUpdate = async (event) => {\n\t\tevent.preventDefault();\n\t\tconsole.log('entering update acc func');\n\t\t//await updateAccountInfo(currentUser.uid,firstName,lastName);\n\t\tlet { firstName, lastName } = event.target.elements;\n\t\tconst first = firstName.value;\n\t\tconst last = lastName.value;\n\t\tconsole.log(\"form data \" + first + \"  \" + last);\n\t\tif (first && last) {\n\t\t\ttry {\n\t\t\t\tawait updateAccountInfo(currentUser.uid, first, last);\n\t\t\t\tsetFormSubmit(true);\n\t\t\t} catch (error) {\n\t\t\t\talert(error);\n\t\t\t}\n\t\t} else alert('enter all info');\n\t};\n\n\t//component code\n\tif (!loading) {\n\t\treturn (\n\t\t\t<div className=\"container\">\n\t\t\t\t<h2>Profile Page</h2>\n\t\t\t\t<div className=\"profile\">\n\t\t\t\t\t{/* <img src={defaultPic} height=\"100\" widht=\"100\"/> */}\n\t\t\t\t\t{user && user.photoURL ? (<p>Profile Picture<img src={user.photoURL} alt='profilePic' height=\"100\" width=\"100\" /></p>) : (<p>Default Picture<br /><img src={defpic} alt='defaultpic' height=\"100\" width=\"100\" /></p>)}\n\t\t\t\t\t<form onSubmit={handleUpload}>\n\t\t\t\t\t\t<input type='file' onChange={handleChange} />\n\t\t\t\t\t\t<button style={{ border: '3px solid black' }}>Change profile picture</button>\n\n\n\t\t\t\t\t</form>\n\t\t\t\t\t{user ? (<p>First Name: {user.firstName}  <br />Last Name: {user.lastName}</p>) : (<p>NOT GETTING USER DATA</p>)}\n\t\t\t\t\t{user && user.posts ? (<div>MY POSTS: {user.posts.map((item) => {\n\t\t\t\t\t\treturn (<div>\n\t\t\t\t\t\t\t<p>Post Details: {item.title} : {item.value}</p>\n\t\t\t\t\t\t\t<p>Post Description: {item.description}</p>\n\t\t\t\t\t\t</div>)\n\t\t\t\t\t})}</div>) : (<p>NOT GETTING any posts</p>)}\n\t\t\t\t</div>\n\n\t\t\t\t<h2>Edit account info</h2>\n\t\t\t\t<form onSubmit={handleAccountUpdate}>\n\t\t\t\t\t<label for=\"firstName\">First Name:</label>\n\t\t\t\t\t<input type=\"text\" id=\"firstName\" name=\"firstName\" placeholder=\"Enter your first name\" />\n\t\t\t\t\t<br></br>\n\t\t\t\t\t<label for=\"lastName\">Last Name:</label>\n\t\t\t\t\t<input type=\"text\" id=\"lastName\" name=\"lastName\" placeholder=\"Enter your last name\" />\n\t\t\t\t\t<br>\n\t\t\t\t\t</br>\n\t\t\t\t\t<button type='submit'>Apply changes</button>\n\t\t\t\t</form>\n\n\n\n\t\t\t\t<br></br>\n\t\t\t\t{change ? <div><ChangePassword /> <button onClick={() => setChange(!change)}>Hide</button></div> : <button onClick={() => setChange(!change)}>Click to Change Password</button>} <br />\n\t\t\t\t<SignOutButton />\n\t\t\t</div>\n\t\t);\n\t} else {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<p> Loading...</p>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default Profile;\n"]},"metadata":{},"sourceType":"module"}